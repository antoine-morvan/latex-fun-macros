%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Welcome to Overleaf --- just edit your LaTeX on the left,
% and we'll compile it for you on the right. If you give
% someone the link to this page, they can edit at the same
% time. See the help menu above for more info. Enjoy!
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass{standalone}
 
\usepackage{tikz}
\usepackage{fp}
\usepackage{pgfplots}
\usepackage{xintexpr}
\usepackage{xstring}
 
%% originaly used with babel french, which causes some issues
%% wihout the following line
\usetikzlibrary{babel}
 
 
\def\colorCycleList{{"blue","red","yellow","green", "orange", "gray" }}
 
 
%%
%% #1 = list of titles and values (not percents)
%%
%%  example : 
%%
%%	\piechart{
%%		(Very Low,37),
%%		(Low,23),
%%		(Average,34),
%%		(High,5),
%%		(Very High,1)
%%	}
%%
\newcounter{totalPieChart}
\newcommand{\piechart}[1]{
	%compute total in order to compute percentages
	\setcounter{totalPieChart}{0}
	\xintForpair ##1##2 in{#1} \do {\addtocounter{totalPieChart}{##2}}
 
	%get the number of colors in the \colorCycleList
	\pgfmathparse{int(dim(\colorCycleList)-1)}
	\edef\cycleColorMax{\pgfmathresult}
 
	\begin{tikzpicture}[nodes = {font=\sffamily}, scale=1]
		\def\angle{0}
		\def\radius{3}
		\newcount\cyclecount \cyclecount=-1
		\newcount\ind \ind=-1
		\xintForpair ##1##2 in{#1} \do {
			\def\currentLoc{##2}
			\def\name{##1}
			\FPeval{\percent}{round(\currentLoc*100/\thetotalPieChart,2)}
			\ifx\percent\empty\else               % If \percent is empty, do nothing
				\global\advance\cyclecount by 1     % Advance cyclecount
				\global\advance\ind by 1            % Advance list index
				\ifnum\cycleColorMax<\cyclecount                 % If cyclecount is larger than list
					\global\cyclecount=0              %   reset cyclecount and
					\global\ind=0                     %   reset list index
				\fi
				\pgfmathparse{\colorCycleList[\the\ind]} % Get color from cycle list
				\edef\color{\pgfmathresult}         %   and store as \color
				% Draw angle and set labels
				\draw[fill={\color!50},draw={\color!50!black!50}] (0,0) -- (\angle:\radius)
				arc (\angle:\angle+\percent*3.6:\radius) -- cycle;
				% do not print the percentage within the pie if the slice is too small
				\ifnum5<\percent
					\node at (\angle+0.5*\percent*3.6:0.7*\radius) {\percent\,\%};
					\node[pin=\angle+0.5*\percent*3.6:\name] at (\angle+0.5*\percent*3.6:\radius) {};
				\else
					\node at (\angle+0.5*\percent*3.6:0.7*\radius) {};
					\node[pin=\angle+0.5*\percent*3.6:\name~(\percent\,\%)] at (\angle+0.5*\percent*3.6:\radius) {};
				\fi
				%at (\angle+0.5*\percent*3.6:{\radius+1.3}) {\percent\%};
				\pgfmathparse{\angle+\percent*3.6}  % Advance angle
				\xdef\angle{\pgfmathresult}         %   and store in \angle
			\fi
		};
	\end{tikzpicture}
}
 
 
\begin{document}
 
\piechart{
	(Very Low,873)
}
\piechart{
	(Very Low,873),
	(Low,1890)
}
\piechart{
	(Very Low,873),
	(Low,1890),
	(Average,3755)
}
\piechart{
	(Very Low,873),
	(Low,1890),
	(Average,3755),
	(High,1165),
	(Very High,325),
	(Low,1890),
	(Average,3755),
	(Low,1890),
	(Average,3755),
	(Very Very High,5)
}
 
\end{document}
